<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Central de Modelagem Inteligente 3D</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#3B82F6',
                        secondary: '#10B981',
                        accent: '#F59E0B'
                    }
                }
            }
        }
    </script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body class="bg-gray-50 min-h-screen">
    <!-- Header -->
    <header class="bg-white shadow-lg">
        <div class="container mx-auto px-4 py-6">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-3">
                    <i class="fas fa-cube text-primary text-3xl"></i>
                    <div>
                        <h1 class="text-2xl font-bold text-gray-800">Sistema de Modelagem Inteligente</h1>
                        <p class="text-gray-600">Integra√ß√£o Slant 3D API + Sistema LGM AI</p>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <div class="bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm">
                        <i class="fas fa-check-circle mr-1"></i>
                        API Slant 3D
                    </div>
                    <div id="lgmStatus" class="bg-yellow-100 text-yellow-800 px-3 py-1 rounded-full text-sm">
                        <i class="fas fa-robot mr-1"></i>
                        LGM AI: Aguardando...
                    </div>
                    <button class="bg-primary text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors">
                        <i class="fas fa-cog mr-2"></i>
                        Configura√ß√µes
                    </button>
                </div>
            </div>
        </div>
    </header>

    <div class="container mx-auto px-4 py-8">
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <!-- Painel de Prompt -->
            <div class="bg-white rounded-xl shadow-lg p-6">
                <h2 class="text-xl font-semibold mb-4 flex items-center">
                    <i class="fas fa-magic text-accent mr-3"></i>
                    Gerador de Prompts Inteligentes
                </h2>
                
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            Descreva seu modelo 3D:
                        </label>
                        <textarea 
                            id="promptInput" 
                            class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent"
                            rows="4" 
                            placeholder="Ex: criar suporte para Raspberry Pi com furos de ventila√ß√£o e encaixe para fonte..."
                        ></textarea>
                    </div>
                    
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">
                                Tipo de Projeto:
                            </label>
                            <select id="projectType" class="w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary">
                                <option value="prototipo">Prot√≥tipo</option>
                                <option value="producao">Produ√ß√£o</option>
                                <option value="estudo">Estudo de viabilidade</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">
                                Complexidade:
                            </label>
                            <select id="complexity" class="w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary">
                                <option value="baixa">Baixa</option>
                                <option value="media" selected>M√©dia</option>
                                <option value="alta">Alta</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-1 gap-3">
                        <button 
                            id="processPrompt" 
                            class="w-full bg-gradient-to-r from-primary to-accent text-white py-3 rounded-lg hover:from-blue-700 hover:to-orange-600 transition-all duration-300 font-semibold"
                        >
                            <i class="fas fa-brain mr-2"></i>
                            Processar Prompt Inteligente
                        </button>
                        
                        <button 
                            id="generateAIModel" 
                            class="w-full bg-gradient-to-r from-purple-600 to-pink-600 text-white py-3 rounded-lg hover:from-purple-700 hover:to-pink-700 transition-all duration-300 font-semibold"
                        >
                            <i class="fas fa-robot mr-2"></i>
                            Gera√ß√£o AI + Projeto Completo
                        </button>
                    </div>
                </div>
            </div>

            <!-- Painel de Resultados -->
            <div class="bg-white rounded-xl shadow-lg p-6">
                <h2 class="text-xl font-semibold mb-4 flex items-center">
                    <i class="fas fa-chart-bar text-secondary mr-3"></i>
                    An√°lise Inteligente
                </h2>
                
                <div id="analysisResults" class="space-y-4">
                    <div class="text-center text-gray-500 py-8">
                        <i class="fas fa-lightbulb text-4xl mb-4"></i>
                        <p>Aguardando processamento do prompt...</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Nova Se√ß√£o LGM - Gera√ß√£o AI -->
        <div class="mt-8 grid grid-cols-1 lg:grid-cols-2 gap-8">
            <!-- Painel de Gera√ß√£o AI -->
            <div class="bg-gradient-to-br from-purple-50 to-pink-50 rounded-xl shadow-lg p-6 border border-purple-200">
                <h2 class="text-xl font-semibold mb-4 flex items-center">
                    <i class="fas fa-robot text-purple-600 mr-3"></i>
                    Gera√ß√£o AI de Modelos 3D
                </h2>
                
                <div class="space-y-4">
                    <div class="bg-white rounded-lg p-4 border border-purple-200">
                        <p class="text-sm text-gray-700 mb-3">
                            <i class="fas fa-magic text-purple-600 mr-2"></i>
                            Use IA para gerar modelos 3D de alta qualidade a partir de descri√ß√µes textuais
                        </p>
                        
                        <div class="grid grid-cols-2 gap-3 text-sm">
                            <div class="flex items-center">
                                <i class="fas fa-check-circle text-green-600 mr-2"></i>
                                <span>Modelos em 5 segundos</span>
                            </div>
                            <div class="flex items-center">
                                <i class="fas fa-check-circle text-green-600 mr-2"></i>
                                <span>Resolu√ß√£o alta</span>
                            </div>
                            <div class="flex items-center">
                                <i class="fas fa-check-circle text-green-600 mr-2"></i>
                                <span>M√∫ltiplas varia√ß√µes</span>
                            </div>
                            <div class="flex items-center">
                                <i class="fas fa-check-circle text-green-600 mr-2"></i>
                                <span>Formato PLY</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-white rounded-lg p-4 border border-purple-200">
                        <h4 class="font-medium text-gray-800 mb-2">Exemplos R√°pidos:</h4>
                        <div class="space-y-2">
                            <div class="text-xs text-purple-700 bg-purple-100 px-2 py-1 rounded cursor-pointer hover:bg-purple-200 transition-colors" 
                                 onclick="setQuickPrompt('um dado de 6 faces com textura de madeira')">
                                üé≤ um dado de 6 faces com textura de madeira
                            </div>
                            <div class="text-xs text-purple-700 bg-purple-100 px-2 py-1 rounded cursor-pointer hover:bg-purple-200 transition-colors" 
                                 onclick="setQuickPrompt('um rob√¥ humanoide com olhos LED azuis')">
                                ü§ñ um rob√¥ humanoide com olhos LED azuis
                            </div>
                            <div class="text-xs text-purple-700 bg-purple-100 px-2 py-1 rounded cursor-pointer hover:bg-purple-200 transition-colors" 
                                 onclick="setQuickPrompt('uma x√≠cara de caf√© com vapor realista')">
                                ‚òï uma x√≠cara de caf√© com vapor realista
                            </div>
                            <div class="text-xs text-purple-700 bg-purple-100 px-2 py-1 rounded cursor-pointer hover:bg-purple-200 transition-colors" 
                                 onclick="setQuickPrompt('um suporte para celular em formato de √°rvore')">
                                üå≥ um suporte para celular em formato de √°rvore
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Painel de Resultados LGM -->
            <div class="bg-white rounded-xl shadow-lg p-6">
                <h2 class="text-xl font-semibold mb-4 flex items-center">
                    <i class="fas fa-cube text-purple-600 mr-3"></i>
                    Resultados LGM
                </h2>
                
                <div id="lgmResults" class="space-y-4">
                    <div class="text-center text-gray-500 py-8">
                        <i class="fas fa-magic text-4xl mb-4"></i>
                        <p>Aguardando gera√ß√£o AI...</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Se√ß√£o de Filamentos -->
        <div class="mt-8 grid grid-cols-1 lg:grid-cols-3 gap-8">
            <!-- Filtros de Material -->
            <div class="bg-white rounded-xl shadow-lg p-6">
                <h3 class="text-lg font-semibold mb-4 flex items-center">
                    <i class="fas fa-filter text-primary mr-2"></i>
                    Filtros de Material
                </h3>
                
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Material:</label>
                        <select id="materialFilter" class="w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary">
                            <option value="">Todos</option>
                            <option value="PLA">PLA</option>
                            <option value="ABS">ABS</option>
                            <option value="PETG">PETG</option>
                        </select>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Cor:</label>
                        <input type="text" id="colorFilter" class="w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary" placeholder="Ex: branco, preto...">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Pre√ßo m√°ximo (USD/g):</label>
                        <input type="number" id="priceFilter" class="w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary" step="0.01" min="0" placeholder="0.00">
                    </div>
                    
                    <button id="searchFilaments" class="w-full bg-secondary text-white py-2 rounded-lg hover:bg-green-700 transition-colors">
                        <i class="fas fa-search mr-2"></i>
                        Buscar Filamentos
                    </button>
                </div>
            </div>

            <!-- Lista de Filamentos -->
            <div class="lg:col-span-2 bg-white rounded-xl shadow-lg p-6">
                <h3 class="text-lg font-semibold mb-4 flex items-center">
                    <i class="fas fa-palette text-accent mr-2"></i>
                    Filamentos Dispon√≠veis
                </h3>
                
                <div id="filamentsList" class="grid grid-cols-1 md:grid-cols-2 gap-4 max-h-96 overflow-y-auto">
                    <div class="text-center text-gray-500 py-8 md:col-span-2">
                        <i class="fas fa-boxes text-4xl mb-4"></i>
                        <p>Clique em "Buscar Filamentos" para carregar</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Calculadora de Custo -->
        <div class="mt-8 bg-white rounded-xl shadow-lg p-6">
            <h3 class="text-xl font-semibold mb-4 flex items-center">
                <i class="fas fa-calculator text-primary mr-3"></i>
                Calculadora de Or√ßamento
            </h3>
            
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Nome do Modelo:</label>
                    <input type="text" id="modelName" class="w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary" placeholder="Ex: Suporte Arduino">
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Volume (cm¬≥):</label>
                    <input type="number" id="modelVolume" class="w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary" step="0.1" min="0" placeholder="50.0">
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Material Preferido:</label>
                    <select id="preferredMaterial" class="w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary">
                        <option value="">Qualquer um</option>
                        <option value="PLA">PLA</option>
                        <option value="ABS">ABS</option>
                        <option value="PETG">PETG</option>
                    </select>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Cor:</label>
                    <input type="text" id="preferredColor" class="w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary" placeholder="Ex: branco">
                </div>
            </div>
            
            <div class="mt-4">
                <button id="calculateBudget" class="bg-gradient-to-r from-secondary to-green-600 text-white py-3 px-6 rounded-lg hover:from-green-700 hover:to-green-800 transition-all duration-300 font-semibold">
                    <i class="fas fa-dollar-sign mr-2"></i>
                    Calcular Or√ßamento
                </button>
            </div>
            
            <div id="budgetResults" class="mt-6 space-y-4">
                <!-- Resultados da calculadora aparecer√£o aqui -->
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-gray-800 text-white py-8 mt-16">
        <div class="container mx-auto px-4 text-center">
            <p class="text-lg font-semibold mb-2">Sistema de Modelagem Inteligente 3D</p>
            <p class="text-gray-400">Powered by Slant 3D API & Central de Controle Inteligente 3dPot</p>
            <div class="mt-4 flex justify-center space-x-6">
                <a href="#" class="text-gray-400 hover:text-white transition-colors">
                    <i class="fab fa-github text-2xl"></i>
                </a>
                <a href="#" class="text-gray-400 hover:text-white transition-colors">
                    <i class="fab fa-linkedin text-2xl"></i>
                </a>
                <a href="#" class="text-gray-400 hover:text-white transition-colors">
                    <i class="fas fa-envelope text-2xl"></i>
                </a>
            </div>
        </div>
    </footer>

    <script>
        // JavaScript para interatividade
        
        // Estado global da aplica√ß√£o
        let sistema = {
            filaments: [],
            currentAnalysis: null,
            apiKey: 'sl-cc497e90df04027eed2468af328a2d00fa99ca5e3b57893394f6cd6012aba3d4'
        };

        // Elementos DOM
        const elements = {
            promptInput: document.getElementById('promptInput'),
            projectType: document.getElementById('projectType'),
            complexity: document.getElementById('complexity'),
            processPrompt: document.getElementById('processPrompt'),
            generateAIModel: document.getElementById('generateAIModel'),
            analysisResults: document.getElementById('analysisResults'),
            lgmResults: document.getElementById('lgmResults'),
            materialFilter: document.getElementById('materialFilter'),
            colorFilter: document.getElementById('colorFilter'),
            priceFilter: document.getElementById('priceFilter'),
            searchFilaments: document.getElementById('searchFilaments'),
            filamentsList: document.getElementById('filamentsList'),
            modelName: document.getElementById('modelName'),
            modelVolume: document.getElementById('modelVolume'),
            preferredMaterial: document.getElementById('preferredMaterial'),
            preferredColor: document.getElementById('preferredColor'),
            calculateBudget: document.getElementById('calculateBudget'),
            budgetResults: document.getElementById('budgetResults')
        };

        // Fun√ß√£o para simular processamento de prompt (em produ√ß√£o, chamaria a API Python)
        function processPromptIntelligently() {
            const prompt = elements.promptInput.value.trim();
            const projectType = elements.projectType.value;
            const complexity = elements.complexity.value;
            
            if (!prompt) {
                showAlert('Por favor, insira uma descri√ß√£o do modelo.', 'error');
                return;
            }
            
            // Simular an√°lise inteligente
            const analysis = analyzePrompt(prompt, projectType, complexity);
            sistema.currentAnalysis = analysis;
            displayAnalysis(analysis);
        }

        function analyzePrompt(prompt, projectType, complexity) {
            // L√≥gica simplificada de an√°lise (em produ√ß√£o seria feita pelo Python)
            const words = prompt.toLowerCase().split(' ');
            
            // Detectar tipo de objeto
            let detectedType = 'pe√ßa gen√©rica';
            let recommendedMaterials = ['PLA'];
            let estimatedTime = '2-4 horas';
            let estimatedCost = '$5-15';
            
            if (words.some(w => ['chassi', 'base', 'estrutura', 'case'].includes(w))) {
                detectedType = 'Estrutura/Suporte';
                recommendedMaterials = ['PLA', 'ABS'];
                estimatedTime = '3-6 horas';
                estimatedCost = '$8-20';
            }
            
            if (words.some(w => ['enclosure', 'caixa', 'gabinete'].includes(w))) {
                detectedType = 'Caixa/Gabinete';
                recommendedMaterials = ['ABS', 'PETG'];
                estimatedTime = '4-8 horas';
                estimatedCost = '$10-30';
            }
            
            return {
                originalPrompt: prompt,
                detectedType: detectedType,
                projectType: projectType,
                complexity: complexity,
                recommendedMaterials: recommendedMaterials,
                estimatedTime: estimatedTime,
                estimatedCost: estimatedCost,
                suggestions: generateSuggestions(prompt, detectedType, projectType),
                configurations: generateConfigurations(detectedType, projectType)
            };
        }

        function generateSuggestions(prompt, type, projectType) {
            const suggestions = [];
            
            if (type === 'Estrutura/Suporte') {
                suggestions.push('Parede m√≠nima recomendada: 2mm para resist√™cia');
                suggestions.push('Furos de fixa√ß√£o: √ò3.5mm para parafusos M3');
                suggestions.push('Toler√¢ncias de encaixe: +0.2mm para pe√ßas m√≥veis');
            }
            
            if (type === 'Caixa/Gabinete') {
                suggestions.push('Espessura m√≠nima: 3mm para durabililidade');
                suggestions.push('Considerar furos de ventila√ß√£o');
                suggestions.push('Adicionar suportes de borboleta para acesso');
            }
            
            if (projectType === 'prototipo') {
                suggestions.push('Use baixo preenchimento (15-20%) para velocidade');
                suggestions.push('Orienta√ß√£o de impress√£o para minimizar supports');
            } else if (projectType === 'producao') {
                suggestions.push('Use preenchimento 30-50% para resist√™ncia');
                suggestions.push('Qualidade alta para acabamento profissional');
            }
            
            return suggestions;
        }

        function generateConfigurations(type, projectType) {
            const configs = {
                'nozzle_temp': '200-220¬∞C',
                'bed_temp': '60-70¬∞C',
                'layer_height': '0.2mm',
                'infill': projectType === 'producao' ? '30%' : '20%',
                'print_speed': '50-60mm/s'
            };
            
            if (type === 'Caixa/Gabinete') {
                configs.bed_temp = '90-100¬∞C';
                configs.enclosure = 'recommended';
            }
            
            return configs;
        }

        function displayAnalysis(analysis) {
            const html = `
                <div class="bg-gray-50 rounded-lg p-4 mb-4">
                    <h4 class="font-semibold text-lg mb-3">An√°lise do Prompt</h4>
                    <div class="grid grid-cols-2 gap-4 mb-4">
                        <div>
                            <span class="text-sm text-gray-600">Tipo Detectado:</span>
                            <p class="font-medium">${analysis.detectedType}</p>
                        </div>
                        <div>
                            <span class="text-sm text-gray-600">Prop√≥sito:</span>
                            <p class="font-medium capitalize">${analysis.projectType}</p>
                        </div>
                        <div>
                            <span class="text-sm text-gray-600">Complexidade:</span>
                            <p class="font-medium capitalize">${analysis.complexity}</p>
                        </div>
                        <div>
                            <span class="text-sm text-gray-600">Tempo Estimado:</span>
                            <p class="font-medium">${analysis.estimatedTime}</p>
                        </div>
                    </div>
                </div>
                
                <div class="bg-blue-50 rounded-lg p-4 mb-4">
                    <h4 class="font-semibold mb-2">Materiais Recomendados</h4>
                    <div class="flex flex-wrap gap-2">
                        ${analysis.recommendedMaterials.map(material => 
                            `<span class="bg-blue-200 text-blue-800 px-3 py-1 rounded-full text-sm">${material}</span>`
                        ).join('')}
                    </div>
                </div>
                
                <div class="bg-green-50 rounded-lg p-4 mb-4">
                    <h4 class="font-semibold mb-2">Sugest√µes Inteligentes</h4>
                    <ul class="list-disc list-inside space-y-1">
                        ${analysis.suggestions.map(suggestion => 
                            `<li class="text-sm text-gray-700">${suggestion}</li>`
                        ).join('')}
                    </ul>
                </div>
                
                <div class="bg-yellow-50 rounded-lg p-4">
                    <h4 class="font-semibold mb-2">Configura√ß√µes de Impress√£o</h4>
                    <div class="grid grid-cols-2 gap-2 text-sm">
                        <div>Temp. Extrusor: <span class="font-medium">${analysis.configurations.nozzle_temp}</span></div>
                        <div>Temp. Mesa: <span class="font-medium">${analysis.configurations.bed_temp}</span></div>
                        <div>Altura de Camada: <span class="font-medium">${analysis.configurations.layer_height}</span></div>
                        <div>Preenchimento: <span class="font-medium">${analysis.configurations.infill}</span></div>
                    </div>
                </div>
            `;
            
            elements.analysisResults.innerHTML = html;
        }

        // Fun√ß√£o para buscar filamentos
        function searchFilaments() {
            const material = elements.materialFilter.value;
            const color = elements.colorFilter.value.trim();
            const maxPrice = elements.priceFilter.value;
            
            // Simular busca de filamentos (em produ√ß√£o seria feita pela API)
            const mockFilaments = generateMockFilaments(material, color, maxPrice);
            displayFilaments(mockFilaments);
        }

        function generateMockFilaments(material, color, maxPrice) {
            const baseFilaments = [
                {id: 'PLA-001', name: 'PLA Premium Branco', color: 'branco', type: 'PLA', price: 0.025, available: true, weight: 1000},
                {id: 'PLA-002', name: 'PLA Premium Preto', color: 'preto', type: 'PLA', price: 0.025, available: true, weight: 1000},
                {id: 'ABS-001', name: 'ABS T√©cnico Cinza', color: 'cinza', type: 'ABS', price: 0.030, available: true, weight: 1000},
                {id: 'PETG-001', name: 'PETG Transparente', color: 'transparente', type: 'PETG', price: 0.040, available: true, weight: 750},
                {id: 'PLA-003', name: 'PLA Formulare3D', color: 'vermelho', type: 'PLA', price: 0.022, available: true, weight: 1000},
                {id: 'ABS-002', name: 'ABS Premium Azul', color: 'azul', type: 'ABS', price: 0.032, available: false, weight: 1000}
            ];
            
            return baseFilaments.filter(f => {
                if (material && f.type !== material) return false;
                if (color && !f.color.includes(color.toLowerCase())) return false;
                if (maxPrice && f.price > parseFloat(maxPrice)) return false;
                return true;
            });
        }

        function displayFilaments(filaments) {
            if (filaments.length === 0) {
                elements.filamentsList.innerHTML = `
                    <div class="text-center text-gray-500 py-8 md:col-span-2">
                        <i class="fas fa-search text-4xl mb-4"></i>
                        <p>Nenhum filamento encontrado com os filtros aplicados</p>
                    </div>
                `;
                return;
            }
            
            const html = filaments.map(filament => `
                <div class="border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow">
                    <div class="flex items-center justify-between mb-2">
                        <h4 class="font-medium text-gray-800">${filament.name}</h4>
                        <span class="text-xs px-2 py-1 rounded-full ${filament.available ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'}">
                            ${filament.available ? 'Dispon√≠vel' : 'Indispon√≠vel'}
                        </span>
                    </div>
                    <div class="space-y-1 text-sm text-gray-600">
                        <div>Cor: <span class="font-medium">${filament.color}</span></div>
                        <div>Tipo: <span class="font-medium">${filament.type}</span></div>
                        <div>Pre√ßo: <span class="font-medium">$${filament.price.toFixed(3)}/g</span></div>
                        <div>Peso: <span class="font-medium">${filament.weight}g</span></div>
                    </div>
                    ${filament.available ? 
                        `<button class="mt-3 w-full bg-primary text-white py-2 rounded text-sm hover:bg-blue-700 transition-colors" 
                                onclick="selectFilament('${filament.id}')">Selecionar</button>` : 
                        `<button class="mt-3 w-full bg-gray-300 text-gray-500 py-2 rounded text-sm cursor-not-allowed" disabled>
                            Indispon√≠vel</button>`
                    }
                </div>
            `).join('');
            
            elements.filamentsList.innerHTML = html;
        }

        // Fun√ß√£o para calcular or√ßamento
        function calculateBudget() {
            const modelName = elements.modelName.value.trim();
            const volume = elements.modelVolume.value;
            const material = elements.preferredMaterial.value;
            const color = elements.preferredColor.value.trim();
            
            if (!modelName || !volume) {
                showAlert('Por favor, preencha o nome do modelo e o volume.', 'error');
                return;
            }
            
            // Simular c√°lculo de or√ßamento
            const budget = generateBudget(modelName, parseFloat(volume), material, color);
            displayBudget(budget);
        }

        function generateBudget(modelName, volume, material, color) {
            // Calcular peso estimado
            const density = material === 'ABS' ? 1.04 : (material === 'PETG' ? 1.27 : 1.24);
            const modelWeight = volume * density;
            
            // Calcular pre√ßos baseados no material
            const pricePerGram = {
                'PLA': 0.025,
                'ABS': 0.030,
                'PETG': 0.040
            };
            
            const basePrice = pricePerGram[material] || 0.025;
            const materialCost = modelWeight * basePrice;
            const totalCost = materialCost * 1.3; // 30% de margem
            
            // Gerar m√∫ltiplas op√ß√µes
            const options = [];
            const materials = material ? [material] : ['PLA', 'ABS', 'PETG'];
            const colors = color ? [color] : ['branco', 'preto', 'cinza', 'azul', 'vermelho'];
            
            materials.forEach(mat => {
                colors.forEach(col => {
                    const weight = volume * (mat === 'ABS' ? 1.04 : (mat === 'PETG' ? 1.27 : 1.24));
                    const cost = weight * pricePerGram[mat] * 1.3;
                    
                    options.push({
                        material: mat,
                        color: col,
                        weight: weight.toFixed(1),
                        cost: cost.toFixed(2),
                        rating: Math.random() * 2 + 7 // Rating 7-9
                    });
                });
            });
            
            options.sort((a, b) => b.rating - a.rating);
            
            return {
                modelName: modelName,
                volume: volume,
                options: options.slice(0, 5), // Top 5
                recommendation: options[0]
            };
        }

        function displayBudget(budget) {
            const html = `
                <div class="bg-gray-50 rounded-lg p-4 mb-4">
                    <h4 class="font-semibold mb-2">Modelo: ${budget.modelName}</h4>
                    <p class="text-sm text-gray-600">Volume: ${budget.volume} cm¬≥</p>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <h4 class="font-semibold mb-3 text-green-700">
                            <i class="fas fa-star mr-2"></i>Recomenda√ß√£o Principal
                        </h4>
                        <div class="bg-green-50 border border-green-200 rounded-lg p-3">
                            <div class="font-medium">${budget.recommendation.material} - ${budget.recommendation.color}</div>
                            <div class="text-sm text-gray-600">Peso: ${budget.recommendation.weight}g</div>
                            <div class="text-lg font-bold text-green-700">$${budget.recommendation.cost}</div>
                            <div class="text-xs text-gray-500">Rating: ${budget.recommendation.rating.toFixed(1)}/10</div>
                        </div>
                    </div>
                    
                    <div>
                        <h4 class="font-semibold mb-3">Outras Op√ß√µes</h4>
                        <div class="space-y-2 max-h-48 overflow-y-auto">
                            ${budget.options.slice(1).map(option => `
                                <div class="bg-gray-50 border rounded p-2 text-sm">
                                    <div class="flex justify-between">
                                        <span class="font-medium">${option.material} - ${option.color}</span>
                                        <span class="font-bold">$${option.cost}</span>
                                    </div>
                                    <div class="text-xs text-gray-500">${option.weight}g ‚Ä¢ Rating: ${option.rating.toFixed(1)}</div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                </div>
                
                <div class="mt-4 p-4 bg-blue-50 rounded-lg">
                    <h4 class="font-semibold mb-2">
                        <i class="fas fa-info-circle mr-2"></i>Informa√ß√µes Importantes
                    </h4>
                    <ul class="text-sm text-gray-700 space-y-1">
                        <li>‚Ä¢ Custos incluem material + margem de produ√ß√£o (30%)</li>
                        <li>‚Ä¢ Tempo estimado: 1-4 horas dependendo da complexidade</li>
                        <li>‚Ä¢ Pre√ßos baseados em filamentos Slant 3D premium</li>
                        <li>‚Ä¢ Toler√¢ncias de ¬±0.2mm j√° inclusas no c√°lculo</li>
                    </ul>
                </div>
            `;
            
            elements.budgetResults.innerHTML = html;
        }

        // Fun√ß√£o para mostrar alertas
        function showAlert(message, type) {
            const alertClass = type === 'error' ? 'bg-red-100 border-red-400 text-red-700' : 'bg-blue-100 border-blue-400 text-blue-700';
            const icon = type === 'error' ? 'fas fa-exclamation-circle' : 'fas fa-info-circle';
            
            const alert = document.createElement('div');
            alert.className = `fixed top-4 right-4 ${alertClass} border px-4 py-3 rounded-lg shadow-lg z-50 max-w-md`;
            alert.innerHTML = `
                <div class="flex items-center">
                    <i class="${icon} mr-2"></i>
                    <span>${message}</span>
                    <button class="ml-auto text-lg font-bold hover:opacity-75" onclick="this.parentElement.parentElement.remove()">√ó</button>
                </div>
            `;
            
            document.body.appendChild(alert);
            
            setTimeout(() => {
                if (alert.parentElement) {
                    alert.remove();
                }
            }, 5000);
        }

        // Event listeners
        document.addEventListener('DOMContentLoaded', function() {
            elements.processPrompt.addEventListener('click', processPromptIntelligently);
            elements.generateAIModel.addEventListener('click', generateAIModelComplete);
            elements.searchFilaments.addEventListener('click', searchFilaments);
            elements.calculateBudget.addEventListener('click', calculateBudget);
            
            // Pressionar Enter no prompt input
            elements.promptInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter' && e.ctrlKey) {
                    processPromptIntelligently();
                }
            });
            
            // Verificar status do LGM
            checkLGMStatus();
        });
        
        // ================================
        // FUN√á√ïES LGM - INTEGRA√á√ÉO AI
        // ================================
        
        // URL base da API
        const API_BASE = 'http://localhost:5000/api';
        
        // Fun√ß√£o para verificar status do LGM
        async function checkLGMStatus() {
            const lgmStatus = document.getElementById('lgmStatus');
            
            try {
                const response = await fetch(`${API_BASE}/lgm/status`);
                const data = await response.json();
                
                if (data.success) {
                    // LGM dispon√≠vel
                    lgmStatus.className = 'bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm';
                    lgmStatus.innerHTML = '<i class="fas fa-robot mr-1"></i>LGM AI: Ativo';
                } else {
                    // LGM n√£o dispon√≠vel
                    lgmStatus.className = 'bg-red-100 text-red-800 px-3 py-1 rounded-full text-sm';
                    lgmStatus.innerHTML = '<i class="fas fa-exclamation-triangle mr-1"></i>LGM AI: Indispon√≠vel';
                }
            } catch (error) {
                // Erro de conex√£o
                lgmStatus.className = 'bg-yellow-100 text-yellow-800 px-3 py-1 rounded-full text-sm';
                lgmStatus.innerHTML = '<i class="fas fa-question-circle mr-1"></i>LGM AI: Sem conex√£o';
            }
        }
        
        // Fun√ß√£o para definir prompt r√°pido
        function setQuickPrompt(prompt) {
            document.getElementById('promptInput').value = prompt;
            showAlert('Prompt carregado! Clique em "Gera√ß√£o AI + Projeto Completo" para gerar.', 'info');
        }
        
        // Fun√ß√£o para gerar modelo AI completo
        async function generateAIModelComplete() {
            const prompt = elements.promptInput.value.trim();
            if (!prompt) {
                showAlert('Por favor, digite uma descri√ß√£o do modelo!', 'error');
                return;
            }
            
            // Atualizar interface
            elements.generateAIModel.disabled = true;
            elements.generateAIModel.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Gerando modelo AI...';
            showLGMStatus('Iniciando gera√ß√£o AI...', 'info');
            
            try {
                // Chamada para o endpoint integrado
                const response = await fetch(`${API_BASE}/lgm/projeto-completo`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        prompt: prompt,
                        include_analysis: true,
                        include_budget: true
                    })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    // Mostrar resultados LGM
                    displayLGMResults(data);
                    showAlert('Projeto completo gerado com sucesso!', 'success');
                } else {
                    showLGMError('Erro na gera√ß√£o: ' + (data.error || 'Erro desconhecido'));
                    showAlert('Erro na gera√ß√£o do modelo AI. Verifique se o servidor est√° rodando.', 'error');
                }
                
            } catch (error) {
                console.error('Erro na gera√ß√£o AI:', error);
                showLGMError('Erro de conex√£o: ' + error.message);
                showAlert('Erro de conex√£o com o servidor. Verifique se est√° rodando em localhost:5000', 'error');
            } finally {
                // Restaurar bot√£o
                elements.generateAIModel.disabled = false;
                elements.generateAIModel.innerHTML = '<i class="fas fa-robot mr-2"></i>Gera√ß√£o AI + Projeto Completo';
            }
        }
        
        // Fun√ß√£o para mostrar status LGM
        function showLGMStatus(message, type = 'info') {
            const lgmResults = document.getElementById('lgmResults');
            const typeClass = type === 'info' ? 'bg-blue-50 border-blue-200 text-blue-800' : 
                            type === 'success' ? 'bg-green-50 border-green-200 text-green-800' :
                            'bg-red-50 border-red-200 text-red-800';
            
            lgmResults.innerHTML = `
                <div class="${typeClass} border rounded-lg p-4">
                    <div class="flex items-center">
                        <i class="fas fa-info-circle mr-2"></i>
                        <span>${message}</span>
                    </div>
                </div>
            `;
        }
        
        // Fun√ß√£o para mostrar erro LGM
        function showLGMError(message) {
            showLGMStatus(message, 'error');
        }
        
        // Fun√ß√£o para exibir resultados LGM
        function displayLGMResults(data) {
            const lgmResults = document.getElementById('lgmResults');
            const stages = data.stages || {};
            
            // Status geral
            const statusEmoji = data.overall_status === 'complete' ? 'üéâ' : 
                              data.overall_status === 'partial' ? '‚ö†Ô∏è' : '‚ùå';
            const statusText = data.overall_status === 'complete' ? 'Conclu√≠do' : 
                             data.overall_status === 'partial' ? 'Parcialmente conclu√≠do' : 'Falhou';
            
            let html = `
                <div class="bg-green-50 border border-green-200 rounded-lg p-4 mb-4">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold text-green-800">${statusEmoji} ${statusText}</h3>
                            <p class="text-sm text-green-600">${data.completion_rate}</p>
                        </div>
                        <div class="text-right text-sm text-green-600">
                            <div>Tempo total:</div>
                            <div class="font-medium">${Math.floor((data.timestamp - Math.floor(data.timestamp)) * 60)}s</div>
                        </div>
                    </div>
                </div>
            `;
            
            // Mostrar cada est√°gio
            html += '<div class="space-y-3">';
            
            // Est√°gio 1: Gera√ß√£o LGM
            if (stages.lgm_generation) {
                const lgm = stages.lgm_generation;
                const lgmEmoji = lgm.success ? '‚úÖ' : '‚ùå';
                const lgmClass = lgm.success ? 'bg-green-50 border-green-200' : 'bg-red-50 border-red-200';
                
                html += `
                    <div class="${lgmClass} border rounded-lg p-4">
                        <h4 class="font-semibold mb-2">${lgmEmoji} Gera√ß√£o AI de Modelo 3D</h4>
                `;
                
                if (lgm.success) {
                    const files = lgm.output_files || [];
                    html += `
                        <div class="text-sm space-y-1">
                            <div><strong>M√©todo:</strong> ${lgm.method || 'N/A'}</div>
                            <div><strong>Tempo:</strong> ${lgm.processing_time?.toFixed(1) || 'N/A'}s</div>
                            <div><strong>Arquivos:</strong> ${files.length} gerados</div>
                            ${files.length > 0 ? `
                                <div class="mt-2">
                                    <div class="font-medium">Arquivos gerados:</div>
                                    <div class="text-xs bg-white p-2 rounded mt-1 max-h-20 overflow-y-auto">
                                        ${files.map(file => `<div>üìÅ ${file}</div>`).join('')}
                                    </div>
                                </div>
                            ` : ''}
                        </div>
                    `;
                } else {
                    html += `
                        <div class="text-sm text-red-700">
                            <div><strong>Erro:</strong> ${lgm.error || 'Erro desconhecido'}</div>
                            ${lgm.note ? `<div><strong>Nota:</strong> ${lgm.note}</div>` : ''}
                        </div>
                    `;
                }
                
                html += '</div>';
            }
            
            // Est√°gio 2: An√°lise do Projeto
            if (stages.project_analysis) {
                const analysis = stages.project_analysis;
                const analysisEmoji = analysis.success ? '‚úÖ' : '‚ùå';
                const analysisClass = analysis.success ? 'bg-blue-50 border-blue-200' : 'bg-red-50 border-red-200';
                
                html += `
                    <div class="${analysisClass} border rounded-lg p-4">
                        <h4 class="font-semibold mb-2">${analysisEmoji} An√°lise do Projeto</h4>
                `;
                
                if (analysis.success) {
                    html += `
                        <div class="text-sm space-y-1">
                            <div><strong>Volume estimado:</strong> ${analysis.volume_estimado || 'N/A'} cm¬≥</div>
                            <div><strong>Complexidade:</strong> ${analysis.complexidade || 'N/A'}</div>
                            <div><strong>Tempo estimado:</strong> ${analysis.tempo_estimado || 'N/A'}</div>
                            ${analysis.materiais_recomendados ? `
                                <div><strong>Materiais:</strong> ${analysis.materiais_recomendados.join(', ')}</div>
                            ` : ''}
                        </div>
                    `;
                } else {
                    html += `<div class="text-sm text-red-700">${analysis.error || 'Erro na an√°lise'}</div>`;
                }
                
                html += '</div>';
            }
            
            // Est√°gio 3: Or√ßamento
            if (stages.budget_calculation) {
                const budget = stages.budget_calculation;
                const budgetEmoji = budget.success ? '‚úÖ' : '‚ùå';
                const budgetClass = budget.success ? 'bg-yellow-50 border-yellow-200' : 'bg-red-50 border-red-200';
                
                html += `
                    <div class="${budgetClass} border rounded-lg p-4">
                        <h4 class="font-semibold mb-2">${budgetEmoji} Or√ßamento Completo</h4>
                `;
                
                if (budget.success) {
                    const custos = budget.custos || {};
                    html += `
                        <div class="text-sm space-y-1">
                            <div><strong>Custo total:</strong> R$ ${custos.total || '0.00'}</div>
                            <div><strong>Material:</strong> R$ ${custos.material || '0.00'}</div>
                            <div><strong>Impress√£o:</strong> R$ ${custos.impressao || '0.00'}</div>
                            <div><strong>Volume:</strong> ${budget.volume_total || 'N/A'} cm¬≥</div>
                        </div>
                    `;
                } else {
                    html += `<div class="text-sm text-red-700">${budget.error || 'Erro no or√ßamento'}</div>`;
                }
                
                html += '</div>';
            }
            
            html += '</div>';
            
            // Adicionar timestamp
            html += `
                <div class="mt-4 text-xs text-gray-500 text-center">
                    Gerado em: ${new Date(data.timestamp * 1000).toLocaleString('pt-BR')}
                </div>
            `;
            
            lgmResults.innerHTML = html;
        }
        
        // Fun√ß√£o para selecionar filamento
        function selectFilament(filamentId) {
            showAlert(`Filamento ${filamentId} selecionado com sucesso!`, 'success');
        }
    </script>
</body>
</html>